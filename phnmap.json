{
    "appid": "865eb6fc-2d5f-4717-a967-4cf33b2a3c7c",
    "name": "NMAP Scanner",
    "description": "This app integrates with <b>NMAP</b> in order to provide detailed network information.",
    "publisher": "Phantom",
    "package_name": "phantom_nmap",
    "type": "information",
    "license": "Copyright (c) Phantom Cyber Corporation 2016-2017",
    "main_module": "nmap_connector.pyc",
    "app_version": "1.0.28",
    "utctime_updated": "2018-12-06T04:33:33.000000Z",
    "product_vendor": "Generic",
    "product_name": "NMAP",
    "product_version_regex": ".*",
    "min_phantom_version": "1.0.240",
    "logo": "nmap.png",
    "rpm_dependencies": "nmap",
    "deb_dependencies": "nmap",
    "configuration": {},
    "actions": [
        {
            "action": "scan network",
            "description": "Execute NMAP scan against a host or subnet",
            "verbose": "<p>If <b>udp_scan</b> is false (it is by default), this action will use the following NMAP command line options: nmap -oX - -sV IP_ADDRESS.</p><p>If <b>udp_scan</b> is true, this action will use the following NMAP command line options: nmap -oX - -sU --privileged IP_ADDRESS.</p><p>Performing a UDP scan requires elevated permissions.  Privileged permissions can be used, if and only if the user first runs this command as root on Phantom:<br><code>sudo setcap cap_net_raw,cap_net_admin,cap_net_bind_service+eip /usr/bin/nmap</code></p><p><b>Warning:</b> UDP function is limited to root for very good reason.  This is dangerous. The NMAP Scripting Engine (NSE) allows scripts to sniff the network, change firewall rules and interface configuration, or exploit vulnerabilities including on localhost. It's possible, especially with elevated capabilities, for a clever person to use NMAP and NSE to escalate to full root privileges. If you do not understand these risks, do not do this.</p><p>To undo the setcap command from before, just run:<br><code>sudo setcap cap_net_raw,cap_net_admin,cap_net_bind_service-eip /usr/bin/nmap</code><br><p>action_result.data.*.udp.* data paths will only be present if <b>udp_scan</b> is true.  They replace action_result.data.*.tcp.* data paths.</p>",
            "type": "investigate",
            "identifier": "nmap_scan",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP address/hostname (CIDR notation supported)",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name",
                        "url"
                    ],
                    "primary": true,
                    "required": true,
                    "order": 0
                },
                "portlist": {
                    "description": "Portlist e.g. 22,80,443,1000-1024",
                    "data_type": "string",
                    "primary": false,
                    "required": false,
                    "order": 1
                },
                "udp_scan": {
                    "description": "UDP Scan",
                    "data_type": "boolean",
                    "primary": false,
                    "required": false,
                    "order": 2
                },
                "script": {
                    "description": "NSE Script",
                    "data_type": "string",
                    "primary": false,
                    "required": false,
                    "order": 3
                },
                "script-args": {
                    "description": "Script parameters",
                    "data_type": "string",
                    "primary": false,
                    "required": false,
                    "order": 4
                }
            },
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "nmap_view.display_scannetwork",
                "title": "Scan Network"
            },
            "output": [
                {
                    "data_path": "action_result.data.*.udp.*.cpe",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.conf",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.name",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ]
                },
                {
                    "data_path": "action_result.data.*.udp.*.state",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.reason",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.product",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.version",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.udp.*.extrainfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.cpe",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.conf",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.name",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ]
                },
                {
                    "data_path": "action_result.data.*.tcp.*.state",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.reason",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.product",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.version",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.tcp.*.extrainfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.hostscript.*.id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.hostscript.*.output.*",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status.state",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status.reason",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.hostnames.*.type",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.hostnames.*.name",
                    "data_type": "string",
                    "contains": [
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vendor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.addresses.ipv4.*.ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.endpoint_state",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.total_open_tcp_ports",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.total_open_udp_ports",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.portlist",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name",
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.parameter.udp_scan",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.parameter.script",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.script-args",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "versions": "EQ(*)"
        }
    ]
}