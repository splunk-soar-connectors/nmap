{
    "appid"       : "865eb6fc-2d5f-4717-a967-4cf33b2a3c7c",
    "name"      : "NMAP Scanner",
    "description" : "NMAP Host and Port Scanner",
    "publisher": "Phantom",
    "package_name": "phantom_nmap",
    "type": "information",
    "license": "Copyright (c) Phantom Cyber Corporation 2016",
    "main_module" : "nmap_connector.pyc",
    "app_version": "1.0.23",
    "utctime_updated": "2016-10-25T05:50:04.000000Z",
    "product_vendor": "Generic",
    "product_name": "NMAP",
    "product_version_regex": ".*",
    "min_phantom_version": "1.0.240",
    "logo": "nmap.png",
    "rpm_dependencies": "nmap",
    "configuration": {
    },
    "actions": [
      {
        "action": "scan network",
        "description": "Execute NMAP scan against an IP or subnet",
        "verbose": "This action will use the following nmap command line options: nmap -oX - -sV xxxx  . <br>  The NMAP Scanner app will also only support a TCP scan today.  UDP scanning and OS fingerprinting require elevated privileges.",
        "type": "investigate",
        "identifier": "nmap_scan",
        "read_only": true,
        "parameters": {
          "ip_hostname": {
            "description": "IP address/hostname (CIDR notation supported)",
            "data_type": "string",
            "contains": ["ip", "host name"],
            "primary": true,
            "required": true,
            "order": 0
          },
          "portlist": {
            "description": "Portlist e.g. 22,80,443,1000-1024",
            "data_type": "string",
            "primary": false,
            "required": false,
            "order": 1
          }
        },
        "render": {
           "type": "custom",
           "width": 10,
           "height": 5,
           "view": "nmap_view.display_scannetwork",
           "title": "Scan Network"
         },
         "output": [
          {
            "data_path": "action_result.data.*.tcp.*.cpe",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.conf",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.name",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.port",
            "data_type": "string",
            "contains": ["port"]
          },
          {
            "data_path": "action_result.data.*.tcp.*.state",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.reason",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.product",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.version",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.tcp.*.extrainfo",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.status.state",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.status.reason",
            "data_type": "string"
          },
          { 
            "data_path": "action_result.data.*.hostnames.*.type",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.hostnames.*.name",
            "data_type": "string",
            "contains": ["host name"]
          },
          {
            "data_path": "action_result.data.*.vendor",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.addresses.ipv4.*.ip",
            "data_type": "string",
            "contains": ["ip"]
          },
          {
            "data_path": "action_result.status",
            "data_type": "string"
          },
          {
            "data_path": "action_result.message",
            "data_type": "string"
          },
          {
            "data_path": "action_result.summary.endpoint_state",
            "data_type": "string"
          },
          {
            "data_path": "action_result.summary.total_open_tcp_ports",
            "data_type": "numeric"
          },
          {
            "data_path": "action_result.parameter.portlist",
            "data_type": "string"
          },
          {
            "data_path": "action_result.parameter.ip_hostname",
            "data_type": "string",
            "contains": ["ip", "host name"]
          },
          {
            "data_path": "summary.total_objects",
            "data_type": "numeric"
          },
          {
            "data_path": "summary.total_objects_successful",
            "data_type": "numeric"
          }
        ],
        "versions":"EQ(*)"
      }
    ]
}
